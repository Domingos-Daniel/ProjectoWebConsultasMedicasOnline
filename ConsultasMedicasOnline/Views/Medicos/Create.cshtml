@model ConsultasMedicasOnline.Models.Medico

@{
    ViewData["Title"] = "Cadastrar Médico";
}

<div class="min-h-screen bg-medical-50 py-8">
    <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
        <!-- Header -->
        <div class="mb-8">
            <div class="flex items-center justify-between">
                <div>
                    <h1 class="text-3xl font-bold text-medical-800">Cadastrar Novo Médico</h1>
                    <p class="text-medical-600 mt-2">Preencha os dados para cadastrar um novo médico no sistema</p>
                </div>
                <a asp-action="Index" class="bg-medical-100 text-medical-700 px-4 py-2 rounded-lg hover:bg-medical-200 transition-colors duration-200 inline-flex items-center">
                    <i class="fas fa-arrow-left mr-2"></i>
                    Voltar à Lista
                </a>
            </div>
        </div>

        <!-- Registration Form -->
        <div class="bg-white rounded-xl shadow-sm border border-medical-200 overflow-hidden">
            <div class="px-6 py-4 bg-gradient-to-r from-primary-600 to-primary-700 border-b border-medical-200">
                <h2 class="text-xl font-semibold text-white flex items-center">
                    <i class="fas fa-user-md mr-3"></i>
                    Informações Profissionais
                </h2>
            </div>

            <form asp-action="Create" method="post" class="space-y-6 p-6">
                <div asp-validation-summary="ModelOnly" class="text-danger"></div>

                <!-- Professional Information -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label asp-for="CRM" class="block text-sm font-medium text-medical-700 mb-2">
                            <i class="fas fa-id-card mr-1 text-primary-600"></i>
                            CRM
                        </label>
                        <input asp-for="CRM" class="w-full px-4 py-3 border border-medical-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors duration-200" 
                               placeholder="Ex: 123456" maxlength="20" />
                        <span asp-validation-for="CRM" class="text-danger text-sm"></span>
                    </div>

                    <div>
                        <label asp-for="EstadoCRM" class="block text-sm font-medium text-medical-700 mb-2">
                            <i class="fas fa-map-marker-alt mr-1 text-primary-600"></i>
                            Estado do CRM
                        </label>
                        <select asp-for="EstadoCRM" class="w-full px-4 py-3 border border-medical-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors duration-200">
                            <option value="">Selecione o estado</option>
                            <option value="AC">Acre</option>
                            <option value="AL">Alagoas</option>
                            <option value="AP">Amapá</option>
                            <option value="AM">Amazonas</option>
                            <option value="BA">Bahia</option>
                            <option value="CE">Ceará</option>
                            <option value="DF">Distrito Federal</option>
                            <option value="ES">Espírito Santo</option>
                            <option value="GO">Goiás</option>
                            <option value="MA">Maranhão</option>
                            <option value="MT">Mato Grosso</option>
                            <option value="MS">Mato Grosso do Sul</option>
                            <option value="MG">Minas Gerais</option>
                            <option value="PA">Pará</option>
                            <option value="PB">Paraíba</option>
                            <option value="PR">Paraná</option>
                            <option value="PE">Pernambuco</option>
                            <option value="PI">Piauí</option>
                            <option value="RJ">Rio de Janeiro</option>
                            <option value="RN">Rio Grande do Norte</option>
                            <option value="RS">Rio Grande do Sul</option>
                            <option value="RO">Rondônia</option>
                            <option value="RR">Roraima</option>
                            <option value="SC">Santa Catarina</option>
                            <option value="SP">São Paulo</option>
                            <option value="SE">Sergipe</option>
                            <option value="TO">Tocantins</option>
                        </select>
                        <span asp-validation-for="EstadoCRM" class="text-danger text-sm"></span>
                    </div>

                    <div>
                        <label asp-for="EspecialidadeId" class="block text-sm font-medium text-medical-700 mb-2">
                            <i class="fas fa-stethoscope mr-1 text-primary-600"></i>
                            Especialidade
                        </label>
                        <select asp-for="EspecialidadeId" asp-items="ViewBag.EspecialidadeId" class="w-full px-4 py-3 border border-medical-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors duration-200">
                            <option value="">Selecione a especialidade</option>
                        </select>
                        <span asp-validation-for="EspecialidadeId" class="text-danger text-sm"></span>
                    </div>

                    <div>
                        <label asp-for="TempoConsultaMinutos" class="block text-sm font-medium text-medical-700 mb-2">
                            <i class="fas fa-clock mr-1 text-primary-600"></i>
                            Duração da Consulta (minutos)
                        </label>
                        <input asp-for="TempoConsultaMinutos" type="number" min="15" max="120" class="w-full px-4 py-3 border border-medical-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors duration-200" 
                               placeholder="30" />
                        <span asp-validation-for="TempoConsultaMinutos" class="text-danger text-sm"></span>
                        <p class="text-xs text-medical-500 mt-1">Tempo padrão: 30 minutos</p>
                    </div>
                </div>

                <!-- Biography -->
                <div>
                    <label asp-for="Biografia" class="block text-sm font-medium text-medical-700 mb-2">
                        <i class="fas fa-user mr-1 text-primary-600"></i>
                        Biografia Profissional
                    </label>
                    <textarea asp-for="Biografia" rows="4" class="w-full px-4 py-3 border border-medical-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors duration-200" 
                              placeholder="Descreva sua formação, experiência e áreas de atuação..."></textarea>
                    <span asp-validation-for="Biografia" class="text-danger text-sm"></span>
                    <p class="text-xs text-medical-500 mt-1">Máximo: 1000 caracteres</p>
                </div>

                <!-- Consultation Settings -->
                <div class="bg-medical-50 rounded-lg p-6">
                    <h3 class="text-lg font-semibold text-medical-800 mb-4 flex items-center">
                        <i class="fas fa-cogs text-primary-600 mr-2"></i>
                        Configurações de Consulta
                    </h3>
                    
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                        <div>
                            <label asp-for="ValorConsulta" class="block text-sm font-medium text-medical-700 mb-2">
                                <i class="fas fa-dollar-sign mr-1 text-success-600"></i>
                                Valor da Consulta (R$)
                            </label>
                            <input asp-for="ValorConsulta" type="number" step="0.01" min="0" class="w-full px-4 py-3 border border-medical-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors duration-200" 
                                   placeholder="150.00" />
                            <span asp-validation-for="ValorConsulta" class="text-danger text-sm"></span>
                            <p class="text-xs text-medical-500 mt-1">Opcional - deixe em branco se não atende particular</p>
                        </div>

                        <div class="flex items-center">
                            <div class="flex items-center h-5">
                                <input asp-for="AceitaParticular" type="checkbox" class="h-4 w-4 text-primary-600 border-medical-300 rounded focus:ring-primary-500" />
                            </div>
                            <div class="ml-3">
                                <label asp-for="AceitaParticular" class="text-sm font-medium text-medical-700">
                                    <i class="fas fa-user mr-1 text-primary-600"></i>
                                    Aceita consulta particular
                                </label>
                                <p class="text-xs text-medical-500">Atendimento de pacientes particulares</p>
                            </div>
                        </div>

                        <div class="flex items-center">
                            <div class="flex items-center h-5">
                                <input asp-for="AceitaConvenio" type="checkbox" class="h-4 w-4 text-primary-600 border-medical-300 rounded focus:ring-primary-500" />
                            </div>
                            <div class="ml-3">
                                <label asp-for="AceitaConvenio" class="text-sm font-medium text-medical-700">
                                    <i class="fas fa-hospital mr-1 text-primary-600"></i>
                                    Aceita convênio
                                </label>
                                <p class="text-xs text-medical-500">Atendimento por planos de saúde</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Help Section -->
                <div class="bg-info-50 border border-info-200 rounded-lg p-4">
                    <h4 class="text-sm font-semibold text-info-800 mb-2 flex items-center">
                        <i class="fas fa-info-circle mr-2"></i>
                        Informações Importantes
                    </h4>
                    <ul class="text-sm text-info-700 space-y-1">
                        <li>• O CRM deve estar ativo no estado informado</li>
                        <li>• A biografia aparecerá no seu perfil público</li>
                        <li>• Os horários de atendimento podem ser configurados após o cadastro</li>
                        <li>• Você pode alterar essas informações a qualquer momento</li>
                    </ul>
                </div>

                <!-- Action Buttons -->
                <div class="flex justify-end space-x-4 pt-6 border-t border-medical-200">
                    <a asp-action="Index" class="px-6 py-3 border border-medical-300 text-medical-700 rounded-lg hover:bg-medical-50 transition-colors duration-200 inline-flex items-center">
                        <i class="fas fa-times mr-2"></i>
                        Cancelar
                    </a>
                    <button type="submit" class="px-6 py-3 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors duration-200 inline-flex items-center">
                        <i class="fas fa-save mr-2"></i>
                        Cadastrar Médico
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

@section Scripts {
    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}
    
    <script>
        // Auto-calculate consultation value based on specialty
        $('#EspecialidadeId').change(function() {
            var especialidadeId = $(this).val();
            if (especialidadeId && !$('#ValorConsulta').val()) {
                // Suggest values based on specialty (these are just examples)
                var suggestedValues = {
                    '1': 150.00, // Cardiologia
                    '2': 120.00, // Dermatologia
                    '3': 180.00, // Neurologia
                    '4': 140.00, // Pediatria
                    '5': 160.00  // Ginecologia
                };
                
                if (suggestedValues[especialidadeId]) {
                    $('#ValorConsulta').val(suggestedValues[especialidadeId]);
                }
            }
        });

        // Format CRM input
        $('#CRM').on('input', function() {
            this.value = this.value.replace(/\D/g, '');
        });

        // Sync particular checkbox with value input
        $('#ValorConsulta').on('input', function() {
            if (this.value && parseFloat(this.value) > 0) {
                $('#AceitaParticular').prop('checked', true);
            }
        });

        $('#AceitaParticular').change(function() {
            if (!this.checked) {
                $('#ValorConsulta').val('');
            }
        });
    </script>
}
